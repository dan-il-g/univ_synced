# Документация к Univ-Приложению

**Задача**: Синхронизировать в обе стороны данные двух систем. Приоритетной назначит систему 1 - мультитабличную

:desktop_computer: [Админка для взаимодействия](https://app.appsmith.com/applications/6076e8ce3fba086367845f5e/pages/6076e8ce3fba086367845f60)
:satellite_antenna: [Инфраструктура в докере](...)

## Запуск приложения

Для запуска необходимо запустить JRE 1.8 или выше.
Возможно, потребует разрешения для Java использовать сеть, необходимо разрешить.
Если нужны скрипты запуска для macos/linux, напишите мне.

## 1 приложение:

**запуск:** multitable.bat
Ctrl-C для завершения

### Факультеты:

Объект с id (число) и name (строка)

http://localhost:8092/app/faculties

1. GET `http://localhost:8092/app/faculties` - получить список

2. GET `http://localhost:8092/app/faculties?id=${id}` (${id} - идентификатор из базы) получить 1

    __Пример ответа:__ 
    ```:json
    {"name": "Строительный", "id": 1618258419920}
    ```



3. POST `http://localhost:8092/app/faculties` добавить, достаточно указывать имя
    __Пример тела запроса:__ 
    ```:json
    {"name": "Физико-технический"}
    ```
    
    __Пример ответа:__ 
    ```:json
    {"name": "Строительный", "id": 1618258419920}
    ```

4. PUT `http://localhost:8092/app/faculties?id=${id}` (${id} - идентификатор из базы) изменить
    __Пример тела запроса:__ 
    ```:json
    {"name": "Физико-технический"}
    ```
### Кафедры:

Объект с id (число), name (строка), faculty (число, идентификатор факультета)

http://localhost:8092/app/deps

1. GET `http://localhost:8092/app/deps` получить список
2. GET `http://localhost:8092/app/deps?id=${id}` (${id} - идентификатор из базы) получить 1
    __Пример ответа:__ 
    ```:json
    {"name": "Архитектуры", "id": 1618258568955, "faculty": 1618258419920}
    ```
 
3. POST `http://localhost:8092/app/deps` добавить, достаточно указывать имя и факультет
    __Пример тела запроса:__ 
    ```:json
    {"name": "Вычислительной техники", "faculty": 1618258419920}
    ```
    __Пример ответа:__ 
    ```:json
    {"name": "Архитектуры", "id": 1618258568955, "faculty": 1618258419920}
    ```
4. PUT `http://localhost:8092/app/deps?id=${id}` (${id} - идентификатор из базы) изменить
    __Пример тела запроса:__ 
    ```:json
    {"name": "Вычислительной техники", "faculty": 1618258419920}
    ```

### Группы:

Объект с id (число), name (строка), faculty (число, идентификатор факультета), department (число, идентификатор кафедры)

http://localhost:8092/app/groups
1. GET `http://localhost:8092/app/groups` получить список
2. GET `http://localhost:8092/app/groups?id=${id}` (${id} - идентификатор из базы) получить 1
    __Пример ответа:__ 
    ```:json
    {"name": "ФТ-21001", "id": 1618258658507, "department": 1618258474887, "faculty": 1618258396481}
    ```
3. POST `http://localhost:8092/app/groups` добавить, достаточно указывать имя, факультет и кафедру
    __Пример тела запроса:__ 
    ```:json
    {"name": "ФТ-21001", "faculty": 1618258396481, "department": 1618258474887}
    ```
    __Пример ответа:__ 
    ```:json
    {"name": "ФТ-21001", "id": 1618258658507, "department": 1618258474887, "faculty": 1618258396481}
    ```
4. PUT `http://localhost:8092/app/groups?id=${id}` (${id} - идентификатор из базы) изменить
    __Пример тела запроса:__ 
    ```:json
    {"name": "ФТ-21001", "faculty": 1618258396481, "department": 1618258474887}
    ```

## 2 приложение:
**запуск:** singletable.bat
Ctrl-C для завершения

### Подразделения:

Объект с id (число), extId (id из внешней системы), name (строка), parentExtId (extId "родительского" из внешней системы)

http://localhost:8091/app/departments

1. GET `http://localhost:8092/app/departments` получить список
    __Пример ответа:__ 
    ```:json
    [
        {
            "name": "Университет",
            "extId": "root",
            "id": 1618260416682
        },
        {
            "parentExtId": "root",
            "name": "Строительный",
            "extId": "1618258419920",
            "id": 1618260530684
        },
        {
            "parentExtId": "1618258419920",
            "name": "Гидравлики",
            "extId": "1618258568955",
            "id": 1618260620644
        }
    ]
    ```

2. GET `http://localhost:8092/app/departments?id=${id}` (${id} - идентификатор из базы) получить 1
3. GET `http://localhost:8092/app/departments?ext-id=${extId}` (${extId} - идентификатор из внешней системы из базы) получить 1
    __Пример ответа:__ 
    ```:json
    {"parentExtId": "root", "name": "Строительный", "extId": "1618258419920", "id": 1618260530684}
    ```
4. POST `http://localhost:8092/app/departments` добавить, достаточно указывать extId, имя, parentExtId (parentExtId не указывать только в случае, если это "корневой" элемент в иерархии)
    __Пример тела запроса 1:__ 
    ```:json
    {"name": "Университет", "extId": "root"}
    ```
    __Пример ответа 1:__ 
    ```:json
    {"name": "Университет", "extId": "root", "id": 1618260416682}
    ```
    ---
    __Пример тела запроса 2:__ 
    ```:json
    {"name": "Строительный", "extId": "1618258419920", "parentExtId": "root"}
    ```
    __Пример ответа 2:__ 
    ```:json
    {"parentExtId": "root", "name": "Строительный", "extId": "1618258419920", "id": 1618260530684}
    ```
5. PUT `http://localhost:8092/app/departments?id=${id}` (${id} - идентификатор из базы) изменить
6. PUT `http://localhost:8092/app/departments?ext-id=${extId}` (${extId} - идентификатор из внешней системы из базы) изменить
    __Пример тела запроса:__ 
    ```:json
    {"name": "Гидравлики", "extId": "1618258568955", "parentExtId": "1618258419920"}
    ```
